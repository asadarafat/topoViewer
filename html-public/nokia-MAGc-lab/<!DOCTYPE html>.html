<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Three.js and Cytoscape.js 3D Nodes</title>
    <!-- Include Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Include Cytoscape.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.18.0/cytoscape.min.js"></script>
    <!-- Include Cytoscape.js stylesheet (optional) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cytoscape/3.18.0/cytoscape.min.css">
</head>
<body>
    <!-- Create a div for the Three.js canvas -->
    <div id="three-canvas" style="width: 100%; height: 400px;"></div>

    <style>
        /* Basic styles for the Three.js canvas container */
        #three-canvas {
            border: 1px solid #ccc;
            background-color: #f8f8f8;
        }
    </style>

    <script>
        // Create a Cytoscape.js graph with 3D position data
        const cy = cytoscape({
            container: document.getElementById('three-canvas'),
            elements: [
                // Nodes with 3D position data (x, y, z)
                { data: { id: 'node1', label: 'Node 1', x: 0, y: 0, z: 0 } },
                { data: { id: 'node2', label: 'Node 2', x: 2, y: 0, z: 0 } },
                { data: { id: 'node3', label: 'Node 3', x: 0, y: 2, z: 0 } },
            ]
        });

        // Create a Three.js scene
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('three-canvas') });
        renderer.setSize(window.innerWidth, 400); // Set canvas size

        // Map Cytoscape.js nodes to Three.js objects (spheres in this example)
        const nodeObjects = {};
        cy.nodes().forEach(node => {
            const geometry = new THREE.SphereGeometry(0.2, 32, 32);
            const material = new THREE.MeshBasicMaterial({ color: 0xff0000 }); // Set color to red
            const sphere = new THREE.Mesh(geometry, material);

            // Set the position of the sphere based on Cytoscape.js node data
            sphere.position.set(node.data('x'), node.data('y'), node.data('z'));

            // Add the sphere to the Three.js scene
            scene.add(sphere);

            // Store a reference to the Three.js object for later use
            nodeObjects[node.id()] = sphere;
        });

        camera.position.z = 5;

        // Animation loop for Three.js
        const animateThree = () => {
            requestAnimationFrame(animateThree);

            // Rotate all spheres in the scene
            for (const nodeId in nodeObjects) {
                if (nodeObjects.hasOwnProperty(nodeId)) {
                    const sphere = nodeObjects[nodeId];
                    sphere.rotation.x += 0.01;
                    sphere.rotation.y += 0.01;
                }
            }

            renderer.render(scene, camera);
        };

        animateThree();
    </script>
</body>
</html>
