name: cups 

mgmt:
  network: custom_mgmt             # management network name
  external-access: false 
  # bridge: br1-private
  ipv4-subnet: 10.10.10.0/24       # ipv4 range

topology:
  kinds:
    vr-sros:
      image: registry.srlinux.dev/pub/vr-sros:23.3.R1
      type: "chassis=sr-1 slot=A card=cpm-1 slot=1 mda/1=me6-100gb-qsfp28 mda/2=me6-100gb-qsfp28"
      license: license-sros23.txt     
  nodes:
    topoviewer:
      kind: linux
      mgmt-ipv4: 10.10.10.200
      image: ghcr.io/asadarafat/topoviewer:development
      ports:
        - 8080:8080
      exec:
        - /opt/topoviewer/topoviewer clab -H 149.204.21.68  -p 8080 -u root -j local-bind/topo-file.yaml 
          #### "149.204.21.68" is the server IP where clab is running
          #### "root" is the ContainerLab host user name
          #### 8080 is the port where topoviewer service run
      entrypoint: /bin/bash
      binds:
        - __clabDir__/topology-data.json:/opt/topoviewer/local-bind/topo-file.yaml:ro
          #### __clabDir__/topology-data.json is path to clab's json file which generated by "clab --export-template"
      labels:
        topo-viewer-role: controller
    MAG-C01:
      kind: vr-sros
      mgmt-ipv4: 10.10.10.201       # set ipv4 address on management network
      image: registry.srlinux.dev/pub/mag-c:23.3.R1
      license: mag-c23.lic
      type: >-
        cp: cpu=8 min_ram=16 chassis=vsr slot=A card=cpm-v ___
        lc: cpu=6 min_ram=16 max_nics=20 chassis=vsr slot=1 card=iom-v mda/1=m20-v ___
        lc: cpu=4 min_ram=32 max_nics=20 chassis=vsr slot=2 card=iom-v-mg mda/1=isa-ms-v ___
        lc: cpu=4 min_ram=32 max_nics=20 chassis=vsr slot=3 card=iom-v-mg mda/1=isa-ms-v 
      # lc: cpu=4 min_ram=32 max_nics=20 chassis=vsr slot=4 card=iom-v-mg mda/1=isa-ms-v ___
      # lc: cpu=4 min_ram=32 max_nics=20 chassis=vsr slot=5 card=iom-v-mg mda/1=isa-ms-v  
      group: ControlPlaneFunction 
      labels:
        topo-viewer-role: controller
    MAG-C02:
      kind: vr-sros
      mgmt-ipv4: 10.10.10.202       # set ipv4 address on management network
      image: registry.srlinux.dev/pub/mag-c:23.3.R1
      license: mag-c23.lic
      type: >-
        cp: cpu=8 min_ram=16 chassis=vsr slot=A card=cpm-v ___
        lc: cpu=6 min_ram=16 max_nics=20 chassis=vsr slot=1 card=iom-v mda/1=m20-v ___
        lc: cpu=4 min_ram=32 max_nics=20 chassis=vsr slot=2 card=iom-v-mg mda/1=isa-ms-v ___
        lc: cpu=4 min_ram=32 max_nics=20 chassis=vsr slot=3 card=iom-v-mg mda/1=isa-ms-v
      # lc: cpu=4 min_ram=32 max_nics=20 chassis=vsr slot=4 card=iom-v-mg mda/1=isa-ms-v ___
      # lc: cpu=4 min_ram=32 max_nics=20 chassis=vsr slot=5 card=iom-v-mg mda/1=isa-ms-v      
      group: ControlPlaneFunction 
      labels:
        topo-viewer-role: controller
    PE-01:
      kind: vr-sros
      mgmt-ipv4: 10.10.10.203       # set ipv4 address on management network
      group: IP-Core 
      labels:
        topo-viewer-role: pe
    AGG-UPF01:
      kind: vr-sros
      mgmt-ipv4: 10.10.10.204       # set ipv4 address on management network
      group: IP-Core  
      labels:
        topo-viewer-role: pe
    AGG-UPF02:
      kind: vr-sros
      mgmt-ipv4: 10.10.10.205       # set ipv4 address on management network
      group: IP-Core  
      labels:
        topo-viewer-role: pe
    Radius:
      kind: linux
      mgmt-ipv4: 10.10.10.211      # set ipv4 address on management network
      image: ghcr.io/asadarafat/freeradius:main
      group: Server
      labels:
        topo-viewer-role: server
    BngBlaster_01:
      kind: linux
      mgmt-ipv4: 10.10.10.212      # set ipv4 address on management network
      image: ghcr.io/asadarafat/bngblaster:main
      group: Residential
      labels:
        topo-viewer-role: rgw
    BngBlaster_02:
      kind: linux
      mgmt-ipv4: 10.10.10.213      # set ipv4 address on management network
      image: ghcr.io/asadarafat/bngblaster:main
      group: Residential
      labels:
        topo-viewer-role: rgw

  links:
          - endpoints: ["MAG-C01:eth1","PE-01:eth3"]
          - endpoints: ["MAG-C02:eth1","PE-01:eth4"]
          - endpoints: ["PE-01:eth1","AGG-UPF01:eth3"]
          - endpoints: ["PE-01:eth2","AGG-UPF02:eth3"]
          - endpoints: ["MAG-C01:eth3","MAG-C02:eth3"]
          - endpoints: ["AGG-UPF01:eth4","AGG-UPF02:eth4"]
          - endpoints: ["Radius:eth1","PE-01:eth5"]  
          - endpoints: ["AGG-UPF01:eth7","BngBlaster_01:eth1"]
          - endpoints: ["AGG-UPF02:eth7","BngBlaster_02:eth1"]

